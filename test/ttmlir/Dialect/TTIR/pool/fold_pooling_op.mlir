// RUN: ttmlir-opt --canonicalize %s | FileCheck %s

// Test 1: Pooling a 2D float tensor with only ones.
module attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false, ttcore.meshes = #ttcore.meshes<[<"mesh" = 1x1>]>} {
    func.func @main() -> (tensor<30x30xbf16> {ttcore.shard_status = #ttcore.shard_status<unsharded>}) {
        // CHECK: %[[FULL:.*]] = "ttir.full"
        // CHECK: fill_value = 4.000000e+00 : f32
        // CHECK: -> tensor<30x30xbf16>
        // CHECK: return %[[FULL]]
        %0 = "ttir.constant"() <{value = dense<1.000000e+00> : tensor<31x31xbf16>}> : () -> tensor<31x31xbf16>
        %3 = ttir.empty() : tensor<30x30xbf16>
        %4 = "ttir.pooling"(%0, %3) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 2, 2>, window_strides = array<i64: 1, 1>}> : (tensor<31x31xbf16>, tensor<30x30xbf16>) -> tensor<30x30xbf16>
        return %4 : tensor<30x30xbf16>
    }
}

// ----
// Test 2: Pooling a 2D float tensor with some ones and some zeros (padding)

module attributes {mhlo.cross_program_prefetches = [], mhlo.input_output_alias = [], mhlo.is_dynamic = false, mhlo.use_auto_spmd_partitioning = false, ttcore.meshes = #ttcore.meshes<[<"mesh" = 1x1>]>} {
    func.func @main() -> (tensor<16x16xbf16> {ttcore.shard_status = #ttcore.shard_status<unsharded>}) {
        // CHECK: %[[CONSTANT:.*]] = "ttir.constant"
        // CHECK: value = dense<"0x804080408040804080408040804080408040804080408040804080408040004080408040804080408040804080408040804080408040804080408040804000408040804080408040804080408040804080408040804080408040804080400040804080408040804080408040804080408040804080408040804080408040004080408040804080408040804080408040804080408040804080408040804000408040804080408040804080408040804080408040804080408040804080400040804080408040804080408040804080408040804080408040804080408040004080408040804080408040804080408040804080408040804080408040804000408040804080408040804080408040804080408040804080408040804080400040804080408040804080408040804080408040804080408040804080408040004080408040804080408040804080408040804080408040804080408040804000408040804080408040804080408040804080408040804080408040804080400040804080408040804080408040804080408040804080408040804080408040004080408040804080408040804080408040804080408040804080408040804000408040804080408040804080408040804080408040804080408040804080400040004000400040004000400040004000400040004000400040004000400040803F">
        // CHECK: -> tensor<16x16xbf16>
        // CHECK: return %[[CONSTANT]]
        %0 = "ttir.constant"() <{value = dense<"0x803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F0000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"> : tensor<32x32xbf16>}> : () -> tensor<32x32xbf16>
        %1 = ttir.empty() : tensor<16x16xbf16>
        %2 = "ttir.pooling"(%0, %1) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 2, 2>, window_strides = array<i64: 2, 2>}> : (tensor<32x32xbf16>, tensor<16x16xbf16>) -> tensor<16x16xbf16>
        return %2 : tensor<16x16xbf16>
    }
}

// ----
// Test 3: Pooling a 2D integer tensor with only ones

module {
    func.func @main() -> tensor<35x35xi32> {
        // CHECK: %[[FULL:.*]] = "ttir.full"
        // CHECK: fill_value = 9 : i32
        // CHECK: -> tensor<35x35xi32>
        // CHECK: return %[[FULL]]
        %0 = "ttir.full"() <{fill_value = 1 : i32, shape = array<i32: 37, 37>}> : () -> tensor<37x37xi32>
        %1 = ttir.empty() : tensor<35x35xi32>
        %2 = "ttir.pooling"(%0, %1) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 3, 3>, window_strides = array<i64: 1, 1>}> : (tensor<37x37xi32>, tensor<35x35xi32>) -> tensor<35x35xi32>
        return %2 : tensor<35x35xi32>
    }
}

// ----
// Test 4: Pooling a 2D integer tensor with some ones and some zeros (padding)

module {
    func.func @main(%arg0: tensor<1x384x35x35xi32>) -> tensor<35x35xi32> {
        // CHECK: %[[CONSTANT:.*]] = "ttir.constant"
        // CHECK: value = dense<"0x04000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000040000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000600000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000006000000060000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000600000006000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000090000000900000009000000060000000400000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000006000000060000000600000004000000">
        // CHECK: -> tensor<35x35xi32>
        // CHECK: return %[[CONSTANT]]
        %0 = "ttir.constant"() <{value = dense<"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"> : tensor<37x37xi32>}> : () -> tensor<37x37xi32>
        %1 = ttir.empty() : tensor<35x35xi32>
        %2 = "ttir.pooling"(%0, %1) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 3, 3>, window_strides = array<i64: 1, 1>}> : (tensor<37x37xi32>, tensor<35x35xi32>) -> tensor<35x35xi32>
        return %2 : tensor<35x35xi32>
    }
}
